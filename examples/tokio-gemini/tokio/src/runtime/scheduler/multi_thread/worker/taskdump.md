这个文件定义了 `Handle` 和 `Shared` 结构体的扩展方法，用于在多线程 Tokio 运行时中转储任务信息。其主要目的是为了调试和性能分析，允许收集关于正在运行的任务的详细信息。

**关键组件：**

*   **`Handle` 结构体的 `trace_core` 方法：**
    *   这个方法是核心功能，负责实际的任务转储过程。
    *   它首先检查核心是否已关闭，如果是则直接返回。
    *   它使用一个超时机制来等待其他工作线程，确保所有线程都准备好进行跟踪。如果超时，则放弃跟踪。
    *   如果当前线程是跟踪的“领导者”，它会执行以下操作：
        *   从共享队列中窃取所有任务到本地队列。
        *   调用 `trace_multi_thread` 函数，该函数实际上收集了任务的跟踪信息。这个函数是不安全的，因为它涉及到对共享数据的操作。
        *   将跟踪结果转换为 `dump::Task` 对象，然后收集到一个 `dump::Dump` 对象中。
        *   将结果存储在 `Shared` 结构体中，供其他线程访问。
        *   通知其他工作线程跟踪已完成。
    *   如果当前线程不是领导者，它会等待领导者完成跟踪，然后返回。
*   **`Shared` 结构体的 `steal_all` 方法：**
    *   这个方法用于从远程队列中窃取所有任务，并将它们移动到本地队列中。
    *   它遍历所有远程队列，并尝试将任务窃取到本地队列中。
    *   它使用 `WorkerMetrics` 和 `Stats` 来跟踪窃取操作的统计信息。

**与其他部分的交互：**

*   `trace_multi_thread` 函数：这个函数是实际执行任务跟踪的地方，它收集任务的详细信息。
*   `dump` 模块：这个模块定义了用于存储和表示任务跟踪信息的结构体，例如 `Task` 和 `Dump`。
*   `loom` 模块：用于同步原语，例如 `Arc`。
*   `Stats` 和 `WorkerMetrics`：用于跟踪任务窃取操作的统计信息。
*   `trace_status`：用于协调多个工作线程之间的跟踪操作。

**总结：**

这个文件定义了 Tokio 运行时中用于任务转储的逻辑，允许收集关于正在运行的任务的详细信息，这对于调试和性能分析非常有用。它通过窃取任务、调用跟踪函数、存储结果和协调线程来实现此功能。
