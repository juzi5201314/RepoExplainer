这个文件定义了 `tokio` 库中的 `join!` 宏，用于并发地执行多个异步表达式。

**宏的目的和功能：**

`join!` 宏允许你同时运行多个异步任务，并在所有任务都完成后返回。它接收一个异步表达式的列表，并将它们并发地在同一个任务上执行。当所有分支都完成时，`join!` 宏会返回一个包含每个分支结果的元组。如果任何一个分支返回 `Err`，`join!` 宏将等待所有分支完成，而不会提前返回。如果需要遇到错误时立即返回，应该使用 `try_join!` 宏。

**关键组件：**

1.  **`doc!` 宏：**
    *   这是一个辅助宏，用于为 `join!` 宏生成文档。它接受一个 `$join:item` 参数，该参数实际上是 `join!` 宏的定义。
    *   `doc!` 宏添加了关于 `join!` 宏的详细文档，包括其用途、用法示例、运行时特性和注意事项。
    *   `#[cfg(doc)]` 和 `#[cfg(not(doc))]` 属性用于在生成文档时和实际编译时分别使用不同的 `join!` 宏定义。

2.  **`join!` 宏的定义：**
    *   **`#[cfg(doc)]` 分支：** 仅在生成文档时使用。它定义了一个占位符 `join!` 宏，用于避免编译错误，因为实际的宏实现是在 `#[cfg(not(doc))]` 分支中。
    *   **`#[cfg(not(doc))]` 分支：** 这是 `join!` 宏的实际实现。它使用嵌套的宏来处理多个异步表达式：
        *   **`@ { ... }` 内部宏：** 这是一个递归宏，用于处理多个输入表达式。它将输入表达式转换为内部表示，并计算表达式的数量。
        *   **`poll_fn`：**  `join!` 宏的核心是使用 `poll_fn` 函数。`poll_fn` 允许创建一个异步的 future，该 future 在每次被轮询时都会轮询所有提供的 future。
        *   **`futures` 元组：**  `join!` 宏将所有异步表达式存储在一个元组中。
        *   **`Pin` 和 `unsafe`：**  由于 `futures` 是一个元组，并且标准库没有提供直接访问元组字段的 `pin!` 宏，因此使用了 `Pin::new_unchecked`。
        *   **轮询机制：**  `join!` 宏使用一个循环来轮询每个 future。为了确保每个 future 都有机会取得进展，轮询的顺序在每次循环迭代时都会发生变化。
        *   **结果收集：**  当所有 future 都完成时，`join!` 宏会从每个 future 中提取结果，并将它们组合成一个元组返回。

**与其他部分的关联：**

*   `join!` 宏是 `tokio` 库中用于并发编程的重要工具。
*   它与 `try_join!` 宏类似，但处理错误的方式不同。
*   它与 `tokio::spawn` 结合使用，以实现并行执行。
*   它依赖于 `tokio::macros::support` 模块中的辅助函数，例如 `maybe_done` 和 `poll_fn`。

**总结：**

这个文件定义了 `tokio` 库中的 `join!` 宏，它允许并发地执行多个异步表达式，并在所有表达式完成后返回结果。它通过使用 `poll_fn` 和 `Pin` 来实现并发轮询，并提供了一个方便的方式来等待多个异步操作完成。
