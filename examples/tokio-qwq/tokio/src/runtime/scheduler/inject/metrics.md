# 文件说明：`tokio/src/runtime/scheduler/inject/metrics.rs`

## 目的  
该文件为 Tokio 运行时调度器的 `Inject` 结构体提供与指标相关的功能，主要用于获取注入队列的当前长度，帮助监控任务调度状态。

## 关键组件  
### 1. `Inject<T>` 结构体  
- **字段**：  
  - `shared`: 共享状态对象（类型为 `Shared<T>`），包含调度器的核心数据结构（如注入队列）。  
  - `synced`: 通过 `Mutex` 保护的同步状态（类型为 `Synced`），用于线程安全的访问。  

### 2. `len()` 方法  
- **功能**：返回注入队列的当前长度。  
- **实现**：通过 `self.shared.len()` 委托给 `Shared` 结构体的 `len()` 方法。  
- **作用**：提供对共享状态中注入队列长度的直接访问，用于监控任务积压情况。

### 3. 相关 `Shared` 结构体（间接关联）  
- **`injection_queue_depth()` 方法**：  
  在 `Shared` 中定义，直接通过 `self.inject.len()` 获取注入队列的实际长度。  
- **`worker_local_queue_depth()` 方法**：  
  获取特定工作线程本地队列的长度（未在当前文件中实现，但属于同一监控体系）。

## 工作原理  
1. **数据流**：  
   - `Inject<T>` 的 `len()` 方法通过 `shared` 字段访问 `Shared` 的状态。  
   - `Shared` 中的 `inject` 队列存储待注入的任务，其长度通过 `injection_queue_depth()` 计算。  

2. **作用场景**：  
   - 当需要监控调度器的负载时，调用 `Inject::len()` 可快速获取注入队列的当前任务数量。  
   - 这一指标可用于调试或优化任务调度性能，例如判断任务是否因队列过长而延迟执行。

## 在项目中的角色  
该文件是 Tokio 调度器模块的指标监控组件，通过暴露注入队列长度的接口，为运行时的状态监控和性能分析提供关键数据支持。
``` 
