### 文件说明：`metric_atomics.rs`

#### 目的
该文件为 Tokio 运行时提供跨平台兼容的原子操作类型（`MetricAtomicU64` 和 `MetricAtomicUsize`），用于安全地记录和操作运行时指标（如任务计数、IO 操作次数等）。通过条件编译适配不同平台的原子操作支持能力，确保在 32/64 位系统上的兼容性。

---

#### 关键组件

1. **`MetricAtomicU64`**
   - **功能**：提供 64 位原子操作，但针对不支持 64 位原子操作的平台进行降级处理。
   - **实现细节**：
     - 使用 `cfg_64bit_metrics!` 宏根据目标平台特性选择实现：
       - **支持 64 位原子操作**：使用 `std::sync::atomic::AtomicU64` 实现完整功能（`load`/`store`/`add` 等）。
       - **不支持时**：所有写操作（如 `store`/`add`）变为无操作（no-op），但保留接口以保证编译通过。
     - 通过 `target_has_atomic = "64"` 条件编译确保结构体字段的正确性。

2. **`MetricAtomicUsize`**
   - **功能**：提供通用的 `usize` 类型原子操作，适用于大多数指标计数场景。
   - **实现细节**：
     - 直接基于 `std::sync::atomic::AtomicUsize` 实现。
     - 提供简化接口：`increment`/`decrement` 方法通过 `fetch_add`/`fetch_sub` 实现高效自增/自减操作。
     - 默认使用 `Relaxed` 内存序以优化性能（适用于指标这类无严格内存顺序要求的场景）。

---

#### 平台适配机制
- **条件编译宏**：
  - `cfg_64bit_metrics!`：启用 64 位原子操作支持（如 x86_64 平台）。
  - `cfg_no_64bit_metrics!`：禁用 64 位原子操作，确保在 32 位或无硬件支持的平台上编译通过。
- **降级策略**：
  - 在不支持 64 位原子操作的平台上，`MetricAtomicU64` 的写操作会被忽略，但保留接口以避免代码逻辑断裂。
  - 读操作（如 `load`）在不支持的平台上被编译器直接移除，防止运行时错误。

---

#### 在项目中的角色
该文件为 Tokio 运行时提供轻量级、跨平台的原子操作工具，确保在多线程环境下对性能指标的原子性操作。通过条件编译适配不同硬件平台的限制，平衡功能完整性与兼容性，是 Tokio 内部指标统计和监控的核心基础组件。
